<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Sample Deployment Guide - Deployment Documentation</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Sample Deployment Guide | Deployment Documentation</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Sample Deployment Guide" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This site is a designed to serve as an example of technical writing work." /> <meta property="og:description" content="This site is a designed to serve as an example of technical writing work." /> <link rel="canonical" href="http://localhost:4000/about/" /> <meta property="og:url" content="http://localhost:4000/about/" /> <meta property="og:site_name" content="Deployment Documentation" /> <script type="application/ld+json"> {"headline":"Sample Deployment Guide","description":"This site is a designed to serve as an example of technical writing work.","@type":"WebSite","url":"http://localhost:4000/about/","name":"Deployment Documentation","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Deployment Documentation </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/portfolio/resume.html" class="nav-list-link">Devina Lee Sheng Tin</a></li><li class="nav-list-item active"><a href="http://localhost:4000/about/" class="nav-list-link active">Sample Deployment Guide</a></li><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Technical Writing Portfolio Website</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Deployment Documentation" aria-label="Search Deployment Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="how-to-deploy-child-applications"> <a href="#how-to-deploy-child-applications" class="anchor-heading" aria-labelledby="how-to-deploy-child-applications"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How To Deploy Child Applications </h1> <p>Identifying information has been redatcted and random characters have been input instead.</p> <h2 id="deploying-to-cloud"> <a href="#deploying-to-cloud" class="anchor-heading" aria-labelledby="deploying-to-cloud"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploying To Cloud </h2> <p>Before you begin deploying, ensure that you have updated all versions in helm-charts and (for UI applications) update the package.json and production/index.html</p> <ul> <li>You can find the latest deployed version of your app by searching for it in Rancher.</li> </ul> <blockquote> <p>Not sure what version number your app should be bumped up to? Check out this quick guide on<a href="https://semver.org/">Semantic Versioning</a></p> </blockquote> <h3 id="build-your-docker-image"> <a href="#build-your-docker-image" class="anchor-heading" aria-labelledby="build-your-docker-image"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Build Your Docker Image </h3> <p>To build your docker image, run the following command where {image_name} is the project</p> <p><code class="language-plaintext highlighter-rouge"> docker build -f path/to/Dockerfile -t $$$$/$$$$/{image_name}:{tag} . </code></p> <p>If you are building a UI image, append the following build argument to the command above</p> <p><code class="language-plaintext highlighter-rouge"> --build-arg npmConfigCmd=setConfig:cloud </code></p> <h3 id="push-docker-image-to-cloud-harbor-registry"> <a href="#push-docker-image-to-cloud-harbor-registry" class="anchor-heading" aria-labelledby="push-docker-image-to-cloud-harbor-registry"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Push Docker Image To Cloud Harbor Registry </h3> <p>Run the following docker command where {image_name} is the project</p> <p><code class="language-plaintext highlighter-rouge"> docker push $$$$/$$$$/{image_name}:{tag} </code></p> <h3 id="update-app-configuration"> <a href="#update-app-configuration" class="anchor-heading" aria-labelledby="update-app-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Update App Configuration </h3> <ul> <li>Find the application you are deploying at <script type="math/tex"></script>$$</li> <li>Click on the row, and hit edit</li> <li>Update the version and bundle version to match the versions of application you are deploying</li> <li>Hit Save</li> </ul> <h3 id="update-secrets--deploy-image-to-kubernetes"> <a href="#update-secrets--deploy-image-to-kubernetes" class="anchor-heading" aria-labelledby="update-secrets--deploy-image-to-kubernetes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Update Secrets &amp; Deploy Image To Kubernetes </h3> <p>Before deploying your image to kubernetes using Helm charts, make any secret/configmap updates that are necessary. Run the following helm command where {release_name} is the project and {chart_directory} (for templates and yaml files) is LIKELY also the project.</p> <p><code class="language-plaintext highlighter-rouge">helm --tiller-namespace=$$$$ --namespace=$$$$ upgrade -i {release_name} {chart_directory} --set=image.repository=$$$$/$$$$/{image_name}, image.tag={tag}, ingress.env=$$$$,ingress.domain=$$$$ </code></p> <h2 id="internal-deployments"> <a href="#internal-deployments" class="anchor-heading" aria-labelledby="internal-deployments"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Internal Deployments </h2> <p>In Jenkins, run the “External to Internal” job for your application. This moves the source code from the Dev Cloud Bitbucket to the On-Prem Bitbucket.</p> <p>For Internal Deployments, you must deploy to Dev and Test in that order. You must also perform any tests necessary to ensure the application is working in each environment prior to deploying to any higher environment.</p> <h3 id="setting-up-docker-image"> <a href="#setting-up-docker-image" class="anchor-heading" aria-labelledby="setting-up-docker-image"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting Up Docker Image </h3> <h4 id="update-helm-charts"> <a href="#update-helm-charts" class="anchor-heading" aria-labelledby="update-helm-charts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Update Helm Charts </h4> <p>Commit and push Helm chart changes (if any) to the <script type="math/tex"></script> Bitbucket repo for this application. Make sure to commit your changes to the <script type="math/tex"></script> branch in <script type="math/tex"></script>, NOT the master branch.</p> <h4 id="build--push-docker-image"> <a href="#build--push-docker-image" class="anchor-heading" aria-labelledby="build--push-docker-image"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Build &amp; Push Docker Image </h4> <ul> <li>Using SSH, login to <script type="math/tex"></script> using Moba Xterm Pro</li> <li>Either clone or <code class="language-plaintext highlighter-rouge">cd</code> into your project and pull down the updated changes.</li> <li>Build Docker Image <ul> <li> <p>Run the following docker command</p> <p><code class="language-plaintext highlighter-rouge">sudo docker build -f path/to/Dockerfile -t artifactory-rco.$$$$.com/$$$$/{image_name}:{tag} .</code></p> </li> <li> <p>If you are building a UI image, append the following argument to the above command</p> </li> </ul> <p><code class="language-plaintext highlighter-rouge"> --build-arg npmConfigCmd=setConfig:internal</code></p> </li> </ul> <h4 id="login-to-artifactory"> <a href="#login-to-artifactory" class="anchor-heading" aria-labelledby="login-to-artifactory"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Login to Artifactory </h4> <p>This should only need to be done the first time you push an image, or if you recently changed your password. Make sure to specify a Docker config file in your home directory.</p> <ul> <li> <p>Run the following docker command</p> <p><code class="language-plaintext highlighter-rouge">sudo docker --config $HOME/.docker login artifactory-rco.centene.com</code></p> </li> <li> <p>When prompted, enter your username and password</p> </li> </ul> <h4 id="push-image-to-artifactory"> <a href="#push-image-to-artifactory" class="anchor-heading" aria-labelledby="push-image-to-artifactory"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Push Image to Artifactory </h4> <p>Make sure to specify a Docker config file in your home directory.</p> <ul> <li> <p>Run the following Docker command</p> <p><code class="language-plaintext highlighter-rouge">sudo docker --config $HOME/.docker push artifactory-rco.$$$$.com/$$$$/{image_name}:{tag}</code></p> </li> <li> <p>Logout of Docker by running the following Docker command</p> <p><code class="language-plaintext highlighter-rouge">sudo docker --config $HOME/.docker logout artifactory-rce.$$$$.com</code></p> </li> </ul> <h3 id="deploying-to-dev"> <a href="#deploying-to-dev" class="anchor-heading" aria-labelledby="deploying-to-dev"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploying to Dev </h3> <ul> <li>Add new bundle.js file to CHP app config in https://centene-health-platform.ckp-dev.centene.com/ (only needed if deploying a CHP child application)</li> <li>Go to https://cje.ccp.centene.com/cjoc/ and login using your AD credentials. <ul> <li>Click on <script type="math/tex"></script></li> <li>Click on <script type="math/tex"></script>-pipelines</li> <li>Click on <script type="math/tex"></script></li> <li>Click on <script type="math/tex"></script></li> </ul> </li> <li>If there are secret/configmap updates that need to be made for your application, upload the new secrets/configmaps using the <script type="math/tex"></script> Jenkins job under Utils.</li> <li>Build the <script type="math/tex"></script> Jenkins job, selecting the appropriate dropdown item for your application and entering the image tag you just pushed to Artifactory. *Go back to <script type="math/tex"></script> &gt; <script type="math/tex"></script>-<script type="math/tex"></script> &gt; <script type="math/tex"></script>-<script type="math/tex"></script> and click on the tab Capture_TruCareNextGen_DockerImagePipeline. There should be a new pipeline at the top of the screen with the first step complete. Ensure that the DockerTag and DockerProject values are correct.</li> <li>Run the <script type="math/tex"></script> Jenkins job from the pipeline view by clicking “trigger” which looks like a small clock After validating the app has successfully deployed, remove the previous bundle.js file from Dev <script type="math/tex"></script> (if applicable).</li> </ul> <h3 id="deploying-to-test"> <a href="#deploying-to-test" class="anchor-heading" aria-labelledby="deploying-to-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploying To Test </h3> <ul> <li>Add new bundle.js file to <script type="math/tex"></script> app config in <script type="math/tex"></script></li> <li>If there are secret/configmap updates that need to be made for your application, upload the new secrets/configmaps using the <script type="math/tex"></script> Jenkins job under Utils.</li> <li>Go to the <script type="math/tex"></script> view in Jenkins, and run the <script type="math/tex"></script> Jenkins job for the pipeline that was created when deploying to Dev.</li> <li>After validating the app has successfully deployed, remove the previous bundle.js file from <script type="math/tex"></script> (if applicable).</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
